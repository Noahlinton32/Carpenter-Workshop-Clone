{"ast":null,"code":"import _slicedToArray from\"C:/Users/Noah Linton/Documents/repos/carpenterServer/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{React,useEffect,useState}from'react';import Navbar from'./components/Navbar';import Login from'./pages/Login';import Students from'./pages/students';import{BrowserRouter as Router,Routes,Route}from'react-router-dom';import'bootstrap/dist/css/bootstrap.min.css';import styled,{createGlobalStyle,css}from'styled-components';import Dashboard from'./pages/Dashboard';import CreateStudents from'./pages/CreateStudent';import Incidents from'./pages/incidents';import CreateIncidents from'./pages/CreateIncident';import Accidents from'./pages/accidents';import CreateAccidents from'./pages/CreateAccident';import Referrals from'./pages/referrals';import CreateReferrals from'./pages/CreateReferral';import Profile from'./pages/profile';import AdminProfile from'./pages/Admin';import EditAccident from'./pages/editAccident';import EditIncident from'./pages/editIncident';import EditReferral from'./pages/editReferral';import EditStudent from'./pages/editStudent';import{AuthProvider,useAuth}from'./authContext';import{useLocation,useNavigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function App(){return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(AuthProvider,{children:/*#__PURE__*/_jsxs(Router,{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",element:/*#__PURE__*/_jsx(Login,{})}),/*#__PURE__*/_jsx(Route,{path:\"/dashboard\",element:/*#__PURE__*/_jsx(RequireAuth,{children:/*#__PURE__*/_jsx(Dashboard,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/students\",element:/*#__PURE__*/_jsx(RequireAuth,{children:/*#__PURE__*/_jsx(Students,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/students/create\",element:/*#__PURE__*/_jsx(RequireAuth,{children:/*#__PURE__*/_jsx(CreateStudents,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/students/edit/:id\",element:/*#__PURE__*/_jsx(RequireAuth,{children:/*#__PURE__*/_jsx(EditStudent,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/incidents\",element:/*#__PURE__*/_jsx(RequireAuth,{children:/*#__PURE__*/_jsx(Incidents,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/incidents/create\",element:/*#__PURE__*/_jsx(RequireAuth,{children:/*#__PURE__*/_jsx(CreateIncidents,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/incidents/edit/:id\",element:/*#__PURE__*/_jsx(RequireAuth,{children:/*#__PURE__*/_jsx(EditIncident,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/accidents\",element:/*#__PURE__*/_jsx(RequireAuth,{children:/*#__PURE__*/_jsx(Accidents,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/accidents/create\",element:/*#__PURE__*/_jsx(RequireAuth,{children:/*#__PURE__*/_jsx(CreateAccidents,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/accidents/edit/:id\",element:/*#__PURE__*/_jsx(RequireAuth,{children:/*#__PURE__*/_jsx(EditAccident,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/referrals\",element:/*#__PURE__*/_jsx(RequireAuth,{children:/*#__PURE__*/_jsx(Referrals,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/referrals/create\",element:/*#__PURE__*/_jsx(RequireAuth,{children:/*#__PURE__*/_jsx(CreateReferrals,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/referrals/edit/:id\",element:/*#__PURE__*/_jsx(RequireAuth,{children:/*#__PURE__*/_jsx(EditReferral,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/profile\",element:/*#__PURE__*/_jsx(RequireAuth,{children:/*#__PURE__*/_jsx(Profile,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/admin\",element:/*#__PURE__*/_jsx(RequireAdmin,{children:/*#__PURE__*/_jsx(AdminProfile,{})})})]})]})})});}function RequireAdmin(_ref){var children=_ref.children;var auth=useAuth();var location=useLocation();var navigate=useNavigate();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isAllowed=_useState2[0],setIsAllowed=_useState2[1];useEffect(function(){if(!auth.user){// If the user is not authenticated, redirect them to the login page\nnavigate(\"/\",{state:{from:location}});}else if(!auth.user.isAdmin){// If the user is not an admin, redirect them to the dashboard\nnavigate(\"/dashboard\",{state:{from:location}});}else{// If the user is an admin, set isAllowed to true\nsetIsAllowed(true);}},[auth.user,navigate,location]);// Render the protected route only if the user is allowed (i.e., an admin)\nreturn isAllowed?children:null;}function RequireAuth(_ref2){var children=_ref2.children;var auth=useAuth();var location=useLocation();var navigate=useNavigate();useEffect(function(){// If the user is not authenticated, redirect them to the login page\nif(!auth.user){navigate(\"/\",{state:{from:location}});}},[auth.user,navigate,location]);// If the user is authenticated, render the protected route\nreturn children;}export default App;","map":{"version":3,"names":["React","useEffect","useState","Navbar","Login","Students","BrowserRouter","Router","Routes","Route","styled","createGlobalStyle","css","Dashboard","CreateStudents","Incidents","CreateIncidents","Accidents","CreateAccidents","Referrals","CreateReferrals","Profile","AdminProfile","EditAccident","EditIncident","EditReferral","EditStudent","AuthProvider","useAuth","useLocation","useNavigate","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","App","children","exact","path","element","RequireAuth","RequireAdmin","_ref","auth","location","navigate","_useState","_useState2","_slicedToArray","isAllowed","setIsAllowed","user","state","from","isAdmin","_ref2"],"sources":["C:/Users/Noah Linton/Documents/repos/carpenterServer/client/src/App.js"],"sourcesContent":["import {React, useEffect, useState} from 'react';\r\nimport Navbar from './components/Navbar';\r\nimport Login from './pages/Login';\r\nimport Students from './pages/students';\r\nimport { BrowserRouter as Router, Routes, Route} from 'react-router-dom';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport styled, {createGlobalStyle, css} from 'styled-components';\r\nimport Dashboard from './pages/Dashboard';\r\nimport CreateStudents from './pages/CreateStudent';\r\nimport Incidents from './pages/incidents';\r\nimport CreateIncidents from './pages/CreateIncident';\r\nimport Accidents from './pages/accidents';\r\nimport CreateAccidents from './pages/CreateAccident';\r\nimport Referrals from './pages/referrals';\r\nimport CreateReferrals from './pages/CreateReferral';\r\nimport Profile from './pages/profile';\r\nimport AdminProfile from './pages/Admin';\r\nimport EditAccident from './pages/editAccident';\r\nimport EditIncident from './pages/editIncident';\r\nimport EditReferral from './pages/editReferral';\r\nimport EditStudent from './pages/editStudent';\r\nimport { AuthProvider,useAuth} from './authContext';\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nfunction App() {\r\nreturn (\r\n  <>\r\n  <AuthProvider>\r\n    <Router>\r\n      <Navbar/>\r\n      <Routes>\r\n        {/* Wrap the entire app with the AuthProvider to make the authentication state available to all components */}\r\n        <Route exact path=\"/\" \r\n        element={\r\n        <Login/>\r\n        } />\r\n        {/* Other routes are wrapped with RequireAuth to protect them */}\r\n         <Route path=\"/dashboard\" \r\n        element={\r\n          <RequireAuth>\r\n        <Dashboard/>\r\n        </RequireAuth>\r\n        } />\r\n        <Route path=\"/students\" \r\n        element={\r\n          <RequireAuth>\r\n        <Students/>\r\n        </RequireAuth>\r\n        } />\r\n        <Route path=\"/students/create\" \r\n        element={\r\n          <RequireAuth>\r\n        <CreateStudents/>\r\n        </RequireAuth>\r\n        } />\r\n        <Route path=\"/students/edit/:id\" \r\n        element={\r\n          <RequireAuth>\r\n        <EditStudent/>\r\n        </RequireAuth>\r\n        } />\r\n        <Route path=\"/incidents\" \r\n        element={\r\n          <RequireAuth>\r\n        <Incidents/>\r\n        </RequireAuth>\r\n        } />\r\n        <Route path=\"/incidents/create\" \r\n        element={\r\n          <RequireAuth>\r\n        <CreateIncidents/>\r\n        </RequireAuth>\r\n        } />\r\n        <Route path=\"/incidents/edit/:id\" \r\n        element={\r\n          <RequireAuth>\r\n        <EditIncident/>\r\n        </RequireAuth>\r\n        } />\r\n        <Route path=\"/accidents\" \r\n        element={\r\n          <RequireAuth>\r\n        <Accidents/>\r\n        </RequireAuth>\r\n        } />\r\n        <Route path=\"/accidents/create\" \r\n        element={\r\n          <RequireAuth>\r\n        <CreateAccidents/>\r\n        </RequireAuth>\r\n        } />\r\n        <Route path=\"/accidents/edit/:id\" \r\n        element={\r\n          <RequireAuth>\r\n        <EditAccident/>\r\n        </RequireAuth>\r\n        } />\r\n        <Route path=\"/referrals\" \r\n        element={\r\n          <RequireAuth>\r\n        <Referrals/>\r\n        </RequireAuth>\r\n        } />\r\n        <Route path=\"/referrals/create\" \r\n        element={\r\n          <RequireAuth>\r\n        <CreateReferrals/>\r\n        </RequireAuth>\r\n        \r\n        } />\r\n        <Route path=\"/referrals/edit/:id\" \r\n        element={\r\n          <RequireAuth>\r\n        <EditReferral/>\r\n        </RequireAuth>\r\n        } />\r\n        <Route path=\"/profile\" \r\n        element={\r\n          <RequireAuth>\r\n        <Profile/>\r\n        </RequireAuth>\r\n        } />\r\n        <Route path=\"/admin\"\r\n        element={\r\n        <RequireAdmin>\r\n          <AdminProfile />\r\n        </RequireAdmin>\r\n        }\r\n          />\r\n      </Routes>\r\n    </Router>\r\n    </AuthProvider>\r\n    \r\n    </>\r\n)}\r\nfunction RequireAdmin({ children }) {\r\n  const auth = useAuth();\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  const [isAllowed, setIsAllowed] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!auth.user) {\r\n      // If the user is not authenticated, redirect them to the login page\r\n      navigate(\"/\", { state: { from: location } });\r\n    } else if (!auth.user.isAdmin) {\r\n      // If the user is not an admin, redirect them to the dashboard\r\n      navigate(\"/dashboard\", { state: { from: location } });\r\n    } else {\r\n      // If the user is an admin, set isAllowed to true\r\n      setIsAllowed(true);\r\n    }\r\n  }, [auth.user, navigate, location]);\r\n\r\n  // Render the protected route only if the user is allowed (i.e., an admin)\r\n  return isAllowed ? children : null;\r\n}\r\nfunction RequireAuth({ children }) {\r\n  const auth = useAuth();\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n  useEffect(() => {\r\n      // If the user is not authenticated, redirect them to the login page\r\n    if (!auth.user) {\r\n      navigate(\"/\", { state: { from: location } });\r\n    }\r\n  }, [auth.user, navigate, location]);\r\n  // If the user is authenticated, render the protected route\r\n  return children;\r\n}\r\nexport default App;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}